on: [push, pull_request]
jobs:
  unit-test:
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - run: ./build.sh unit-test
      - uses: actions/upload-artifact@v4
        with:
          name: test-results
          path: test/TestResults/test-results.html
  build:
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - run: ./build.sh compile-main pack --configuration Release
      - uses: actions/upload-artifact@v4
        with:
          name: netstandard2.0
          path: src/Dvchevskii.Unit/bin/Release/netstandard2.0
      - uses: actions/upload-artifact@v4
        with:
          name: packages
          path: src/Dvchevskii.Unit/bin/Release/Dvchevskii.Unit.*.*nupkg
