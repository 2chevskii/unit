on:
  release:
    types: published
jobs:
  push:
    runs-on: ubuntu-22.04
    permissions:
      contents: read
      packages: write
    steps:
      - name: âœ… Checkout repository
        uses: actions/checkout@v4
        with: { fetch-depth: 0 }
      - name: ðŸ”½ Download release assets
        run: ./build.sh DownloadGithubReleaseAssets
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      - id: nuget_push_nuget_org
        name: ðŸšš Push packages to NuGet feed (nuget.org)
        run: ./build.sh NuGetPush --nuget-feed 'https://api.nuget.org/v3/index.json'
        env:
          NUGET_API_KEY: ${{ secrets.NUGET_API_KEY }}
      - id: nuget_push_github
        name: ðŸšš Push packages to NuGet feed (github.com)
        run: ./build.sh NuGetPush --nuget-feed 'https://nuget.pkg.github.com/${{ github.repository_owner }}/index.json'
        env:
          NUGET_API_KEY: ${{ secrets.GITHUB_TOKEN }}
    outputs:
      nuget_org_package_url: ${{ steps.nuget_push_nuget_org.outputs.package_url }}
      github_package_url: ${{ steps.nuget_push_github.outputs.package_url }}
